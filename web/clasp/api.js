const paths__={},mwBefore__=[],mwAfter__=[];function doGet(){return HtmlService.createHtmlOutputFromFile("index")}async function apiListener(e){let t=null;try{t=JSON.parse(e);const o={body:"",status:200,headers:[]};if(!paths__[t.path])throw new Error(`Path "${t.path}" does not exist`);const a=mwBefore__.length;for(let e=0;e<a;e++)await mwBefore__[e](t,o);const r=await paths__[t.path](t,o);o.body=o.body||r;for(let e=0;e<mwAfter__.length;e++)await mwAfter__[e](t,o);return o}catch(e){return console.error(e),{error:e&&e.message?e.message:e,status:500,body:""}}}(()=>{"use strict";var e=(e,t)=>{paths__[e]=t};e("getSheetData",e=>CRUD_getSheetData(e.body.sheetName)),e("addRow",e=>CRUD_addRow(e.body.sheetName,e.body.rowData)),e("updateRow",e=>CRUD_updateRow(e.body.sheetName,e.body.rowIndex,e.body.rowData)),e("deleteRow",e=>CRUD_deleteRow(e.body.sheetName,e.body.rowIndex)),e("getAllowedSheets",()=>CRUD_getAllowedSheets())})();