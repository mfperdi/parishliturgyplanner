const paths__={},mwBefore__=[],mwAfter__=[];function doGet(){return HtmlService.createHtmlOutputFromFile("index")}async function apiListener(e){let t=null;try{t=JSON.parse(e);const o={body:"",status:200,headers:[]};if(!paths__[t.path])throw new Error(`Path "${t.path}" does not exist`);const r=mwBefore__.length;for(let e=0;e<r;e++)await mwBefore__[e](t,o);const i=await paths__[t.path](t,o);o.body=o.body||i;for(let e=0;e<mwAfter__.length;e++)await mwAfter__[e](t,o);return o}catch(e){return console.error(e),{error:e&&e.message?e.message:e,status:500,body:""}}}(()=>{"use strict";var e=(e,t)=>{paths__[e]=t};e("getSheetData",e=>CRUD_getSheetData(e.body.sheetName)),e("addRow",e=>CRUD_addRow(e.body.sheetName,e.body.rowData)),e("updateRow",e=>CRUD_updateRow(e.body.sheetName,e.body.rowIndex,e.body.rowData)),e("deleteRow",e=>CRUD_deleteRow(e.body.sheetName,e.body.rowIndex)),e("getAllowedSheets",()=>CRUD_getAllowedSheets()),e("getMonths",()=>getMonthsForSidebar()),e("generateCalendar",()=>triggerCalendarGeneration()),e("validateData",()=>VALIDATE_all()),e("generateSchedule",e=>triggerScheduleGeneration(e.body.monthString)),e("updateTimeoffForm",e=>TIMEOFFS_updateFormForMonth(e.body.monthString)),e("getPendingTimeoffs",e=>WEBAPP_getPendingTimeoffs(e.body.monthString)),e("approveTimeoff",e=>WEBAPP_approveTimeoff(e.body.rowIndex,e.body.notes)),e("rejectTimeoff",e=>WEBAPP_rejectTimeoff(e.body.rowIndex,e.body.notes)),e("bulkApproveClean",()=>TIMEOFFS_bulkApprovePending()),e("autoAssign",e=>triggerAssignment(e.body.monthString)),e("getActiveMinistries",()=>getActiveMinistries()),e("getNext12Months",()=>getNext12Months()),e("getMonthlyViewStatus",()=>getCurrentMonthlyViewStatus()),e("setMonthlyViewFilter",e=>setMonthlyViewMinistryFilter(e.body.ministry)),e("regenerateViews",()=>regenerateMonthlyViewsManually()),e("generateCustomPrint",e=>generateCustomPrint(e.body.monthString,e.body.ministry,e.body.sheetName)),e("getWeeklyEmailText",()=>getScheduleForEmailCopy({})),e("generateDashboard",e=>DASHBOARD_generateSimplified(e.body.monthString)),e("publishAll",e=>PUBLISH_publishAllMinistries(e.body.monthString)),e("publishMinistry",e=>PUBLISH_syncMonthlyViewToPublic(e.body.monthString,{ministryFilter:[e.body.ministry]})),e("getAutoPublishStatus",()=>AUTOPUBLISH_getStatus()),e("enableAutoPublish",()=>AUTOPUBLISH_setupTrigger(30)),e("disableAutoPublish",()=>AUTOPUBLISH_removeTrigger()),e("archiveYear",e=>ARCHIVE_createArchiveFile(e.body.year)),e("listArchives",()=>ARCHIVE_listArchives()),e("clearOldData",e=>ARCHIVE_clearOldData(e.body.sheetsToRestart))})();